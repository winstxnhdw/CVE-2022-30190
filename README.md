# CVE-2022-30190 (Follina)

Proof of concept for CVE-2022-30190 (Follina).

## Requirements

- Windows 10 21H1 or earlier
- Security update KB5016616 not installed

### Development

- [Microsoft .NET SDK](https://dotnet.microsoft.com/en-us/download)
- Python 3.9 or later

## Usage

### Trojan

Build the trojan with the following shell command. This will create the `trojan.docx` file and initialise the attacker's server.

```bash
python init.py <port>
```

### Payload

Automatically build the payload and remove unnecessary binaries with the following batch script.

```ps1
.\build_payload.bat
```

### Clean up

To permanently delete this directory and everything in it, run the following batch script.

```ps1
.\destroy_all.bat
```

## Notes

- To execute more complex PowerShell commands, these commands **must** be Base64 encrypted.

- [index.html](build/index.html) cannot run JavaScript. For whatever reason, only `location.href` works.

- For long running commands, a troubleshooter will appear when the victim opens the document. The victim can inadvertently deny the attack by cancelling the troubleshooter. Ensure that the command runtime is short.
